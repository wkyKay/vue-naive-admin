import { minify } from 'html-minifier-terser';
const defaultMinifyOptions = {
    collapseWhitespace: true,
    keepClosingSlash: true,
    removeComments: true,
    removeRedundantAttributes: true,
    removeScriptTypeAttributes: true,
    removeStyleLinkTypeAttributes: true,
    useShortDoctype: true,
    minifyCSS: true,
};
export default function simpleHtmlPlugin({ minify: minifyOptions = false } = {}) {
    return {
        name: 'vite:simple-html:minify',
        transformIndexHtml: {
            order: 'post',
            handler: async (html) => {
                let result = html;
                if (minifyOptions) {
                    result = await minify(result, minifyOptions === true ? defaultMinifyOptions : minifyOptions);
                }
                return result;
            },
        },
    };
}
